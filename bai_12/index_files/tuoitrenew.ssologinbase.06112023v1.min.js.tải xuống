function isStarTemplate(n){if(n){var t=getCookie(loginSSO.cookieNameStarRedTemplate);return typeof t!="undefined"&&t!=null&&t!=""&&t==1&&n?!1:!0}return!1}function signalRComment(n){try{loadJsAsync("https://static-tuoitre.tuoitre.vn/tuoitre/web_js/signalr.min.js",function(){function i(){try{t.start()}catch(n){console.log(n);setTimeout(()=>i(),5e3)}}const t=(new signalR.HubConnectionBuilder).withUrl("https://ids2.tuoitre.vn/comment?uid="+n).withAutomaticReconnect().configureLogging(signalR.LogLevel.Information).build();t.onreconnecting(n=>{document.getElementById("messageInput").disabled=!0;const t=document.createElement("li");t.textContent=`Connection lost due to error "${n}". Reconnecting.`;document.getElementById("messageList").appendChild(t)});t.onreconnected(n=>{document.getElementById("messageInput").disabled=!1;const t=document.createElement("li");t.textContent=`Connection reestablished. Connected with connectionId "${n}".`;document.getElementById("messageList").appendChild(t)});t.onclose(n=>{document.getElementById("messageInput").disabled=!0;const t=document.createElement("li");t.textContent=`Connection closed due to error "${n}". Try refreshing this page to restart the connection.`;document.getElementById("messageList").appendChild(t)});t.onclose(()=>{i()});i();t.on("ReceiveCommentAction",t=>{var f,r;if(t!=null){$("#notifyComment").show();var e=`<a class="notifycomment" id="{5}" style="display:none;" href="javascript:;" {0} title="{1}">
                        <img src="{2}" alt="{1}"/>
                            <span class="info_noti"><span class="txtcount">{3}</span><span class="spritecmt {4}"></span></span></a>`,u="",i=JSON.parse(t.message),o=$("#hidNewsId").val();if(console.log(i),i.comment.object_id.indexOf(o)!=-1)switch(t.action){case"reaction":u="";i.comment!=null&&(f=i.comment.sender_avatar==null||i.comment.sender_avatar==""?"https://static-tuoitre.tuoitre.vn/tuoitre/web_images/userdeffault.jpg":i.comment.sender_avatar,r=(Math.random()+1).toString(36).substring(2),u=String.format(e,"onclick=\"clickPopupComment(this,'"+i.comment.id+"','"+n+"','"+f+"','"+i.comment.object_id+"','"+Base64.encode(i.comment.object_title)+"','"+i.comment.object_url+"','"+i.comment.zone_id+"');\"","",f,i.rate_count,getIconReactById(i.rate_type),r),$("#notifyComment").append(u),$("#notifyComment").find(".notifycomment").length>3&&$("#notifyComment").find(".notifycomment").first().remove(),$("#"+r).stop().slideToggle(300),setTimeout(function(){$("#"+r).fadeOut(300)},2e4));break;case"reply":case"approved":u="";i.comment!=null&&(f=i.comment.sender_avatar==null||i.comment.sender_avatar==""?"https://static-tuoitre.tuoitre.vn/tuoitre/web_images/userdeffault.jpg":i.comment.sender_avatar,r=(Math.random()+1).toString(36).substring(2),u=String.format(e,"onclick=\"clickPopupComment(this,'"+i.comment.id+"','"+n+"','"+f+"','"+i.comment.object_id+"','"+Base64.encode(i.comment.object_title)+"','"+i.comment.object_url+"','"+i.comment.zone_id+"');\"","",f,1,"icocomment",r),$("#notifyComment").append(u),$("#notifyComment").find(".notifycomment").length>3&&$("#notifyComment").find(".notifycomment").first().remove(),$("#"+r).stop().slideToggle(300),setTimeout(function(){$("#"+r).fadeOut(300)},2e4))}}});$(".closenotify").off("click").on("click",function(){$("#notifyComment").stop().slideToggle(300,"swing",function(){$("#notifyComment").find(".notifycomment").remove()})})})}catch(t){console.log("ErrSigR:"+t)}}function clickPopupComment(n,t,i,r,u,f,e,o){$("body").addClass("open-modalcomment");$(".modal__commentpopup .lstcommentpopup").unbind("scroll");$(".modal__commentpopup .viewmore-comment").css({visibility:"visible",opacity:1});commentv2.initSendComment("#popupFormComment",u,e,f,o,"","",i,"",r);commentv2.initListCommentBase("#boxCommentPopup",u,f,o,!0,"","",i,"",r,_userloginobject_sso,2,t);n.remove()}function stickyWrapper(n){var t=$.extend({afterSticky:function(){}},n),i=$(t.elem_sticky),e=$(t.elem_container),o=e.offset().top,r=$(window).height(),u=0,f=-1;$(window).scroll(function(){var n=$(this).scrollTop(),e=i.outerHeight(),s=$(t.elem_wrapper).offset().top+e;$(window).scrollTop()>o&&$(window).scrollTop()<=s-r?n<u&&$(window).scrollTop()<=f&&i.css({position:"fixed",top:40,bottom:"unset",width:t.elm_width}):$(window).scrollTop()>s-r?$(window).scrollTop()>$(t.elem_split).offset().top-r?i.css({position:"absolute",top:"auto",bottom:0,width:t.elm_width}):(curemttopelm_up=n,f=$(t.elem_sticky).offset().top,n>u?i.css({position:"fixed",top:(e-r)*-1,bottom:"unset",width:t.elm_width}):i.css({position:"absolute",top:"auto",bottom:0,width:t.elm_width})):i.css("position","static");u=n})}var isTuoitreSao=!1,intervalHomeFunc=null;let _gl_userId="",_userloginobject_sso=null;var loginSSO={checkPage:$("#hidCheckPage").val(),cookieNamePack:"_ckpackstar",cookieNameStarRedTemplate:"_ckstartemp",getUserInfo:function(n){$.ajax({url:pageSettings.SSOapiurl+"/api/front/v1/auth/info",headers:{Accept:"application/json"},method:"GET",type:"GET",xhrFields:{withCredentials:!0},success:function(t){typeof n=="function"&&n(t)},error:function(t){typeof n=="function"&&n(t)}})},getCurrentStar:function(n){var t=this;t.getUserInfo(function(t){if(t.code==200){var i=t.data;if(i!=null)if(typeof n=="function")n(i.star);else return i.star}})},init:function(){var n=this;$.ajax({url:pageSettings.SSOapiurl+"/api/front/v1/auth/info",headers:{Accept:"application/json"},method:"GET",type:"GET",xhrFields:{withCredentials:!0},success:function(t){var i,u,r;t.code==200?(i=t.data,i!=null?(_gl_userId=i.id,signalRComment(_gl_userId),dataLayer.push({event:"user_login_sucess",userInfo:i}),_userloginobject_sso=i,u=i.avatarPath!=null&&i.avatarPath!=""?i.avatarPath:"https://static-tuoitre.tuoitre.vn/tuoitre/web_images/userdeffault.jpg",r=i.name==null||i.name==""?i.email:i.name,r=r==null||r==""?i.phone:r,$("#head_login").hide(),$("#head_islogin").fadeIn(),i.expire=i.expire*1e3,i.birthTimestamp=i.birthTimestamp*1e3,$("[data-uinfo]").each(function(){var f=$(this).attr("data-uinfo"),e;if(f=="name"&&$(this).text(r),f=="avatar_path"&&$(this).attr("src",u),f=="expireddate")if(i.expire>0){var n=new Date(i.expire).getDate(),t=new Date(i.expire).getMonth()+1,o=new Date(i.expire).getFullYear();n=n<10?"0"+n:n;t=t<10?"0"+t:t;$(this).text(n+"/"+t+"/"+o)}else $(this).parent(".txtalert").length>0&&$(this).parent(".txtalert").text("Bạn chưa mua gói ");e=parseInt("0"+i.star);f=="tokenstar"&&$(this).text(e.format(0,3,".",","))}),n.insertUser3rd(i),n.initPageView(i)):n.initActionNotLogin()):n.initActionNotLogin()},error:function(){n.initActionNotLogin()}});n.loginClick()},initActionNotLogin:function(){var n=this;n.initPageView(null);$("#head_login").fadeIn();$("#head_islogin").hide()},initPageView:function(n){var t=this,i=!1,r,u,f;n!=null?(n.expire>0&&new Date(n.expire)>new Date&&(isTuoitreSao=!0),i=isStarTemplate(isTuoitreSao),i,$('[data-view="visible-nologin"]').removeAttr("data-view"),setCookie("_ck_isLogin",!0,2592e3)):($('[data-view="visible-login"]').removeAttr("data-view"),setCookie("_ck_isLogin",!1,2592e3));r=getCookie("_ck_user");r!=i+""&&(setCookie("_ck_user",i,2592e3),r!=""&&window.location.reload());setCookie("_ck_user",i,2592e3);setCookie("_ck_isTTSao",isTuoitreSao,2592e3);t.initActionStar(i,isTuoitreSao);i||$("#advfootpage").length>0&&appSettings.allowAds&&(u=1e3,$("#elementLoadDataFooter").length>0&&(u=$("#elementLoadDataFooter").offset().top),f=!0,$(window).scroll(function(){var n=$(this).scrollTop();n>=u&&f&&(ajaxBoxCoHoiMuaSam("#advfootpage",100001),f=!1)}));t.checkPage=="trang-chu"&&pageInit.home(n,i,isTuoitreSao);t.checkPage=="detail"&&(Detail.DonateStarAuthor(n),pageInit.detail(n,i));t.checkPage=="detailmagazine"&&pageInit.detailmagazine(n,i);t.checkPage=="video-detail-start"&&pageInit.videoDetailStart(n,isTuoitreSao);t.checkPage=="video-detail"&&pageInit.videoDetail(n,isTuoitreSao);t.checkPage=="video-list"&&pageInit.videoList(n,isTuoitreSao);t.checkPage=="video-list-start"&&pageInit.videoListStart(n,isTuoitreSao);t.checkPage=="video-home"&&pageInit.videoHome(n,isTuoitreSao);t.checkPage=="dang-ky-tuoi-tre-sao"&&pageInit.registerStar(n,isTuoitreSao);t.checkPage=="list"&&pageInit.list(i);t.checkPage=="foryou"&&pageInit.foryou(i,isTuoitreSao)},initActionStar:function(n,t){var i=this;$('*[data-atc="atc-startemp"]').each(function(){$(this).hide()});$('*[data-atc="logouttemplatestar"]').each(function(){$(this).hide()});n?($("body").addClass("blue-style"),$('*[data-atc="atc-nonstar"]').each(function(){$(this).hide()}),$('*[data-atc="atc-star"]').each(function(){$(this).show()}),$('*[data-atc="atc-startemp"]:not(.templatestarbtn)').each(function(){$(this).show()}),t&&$('*[data-atc="logouttemplatestar"]').each(function(){$(this).show()})):($("body").removeClass("blue-style"),$('*[data-atc="atc-star"]').each(function(){$(this).hide()}),t?($('[data-view="hidebylogin"]').hide(),$('*[data-atc="atc-nonstar"]:not(.templatestarbtn)').each(function(){$(this).show()}),$('*[data-atc="atc-startemp"]').each(function(){$(this).show()}),$('*[data-atc="atc-nonstartemp"]').each(function(){$(this).hide()}),$(".submit-register-tto-star").hide()):($('*[data-atc="atc-nonstar"]').each(function(){$(this).show()}),$('*[data-atc="atc-starclick"]').find("a").each(function(){$(this).attr("href","javascript:;");$(this).on("click",function(n){return n.preventDefault(),window.location.href="/dang-ky-tuoi-tre-sao.htm",!1})}),$('*[data-atc="atc-startemp"]').each(function(){$(this).hide()}),$(".introduce_tto").addClass("visibled")))},adsCore:function(){appSettings.allowAds&&(loadCss("https://quangcao.tuoitre.vn/static/js/cms_ads.css"),loadJsAsync("https://quangcao.tuoitre.vn/static/js/cms_ads.js"),loadJsAsync("https://static.amcdn.vn/tka/cdn.js"),loadJsAsync("https://media1.admicro.vn/cms/Arf.min.js",callbackEr=function(){window.arferrorload=!0}),function(n,t,i,r,u){n[r]=n[r]||[];n[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var e=t.getElementsByTagName(i)[0],f=t.createElement(i),o=r!="dataLayer"?"&l="+r:"";f.async=!0;f.src="https://www.googletagmanager.com/gtm.js?id="+u+o;e.parentNode.insertBefore(f,e)}(window,document,"script","dataLayer","GTM-KG7C9D4"))},loginClick:function(){function t(){$.ajax({url:pageSettings.SSOapiurl+"/api/front/v1/auth/logout",headers:{Accept:"application/json"},method:"POST",type:"POST",xhrFields:{withCredentials:!0},success:function(n){n.code==200?(setCookie("_ck_user",null,0),setCookie("_ck_insertuser",null,0),setCookie("_ck_isTTSao",null,0),setCookie("_ck_isLogin",null,0),setCookie(loginSSO.cookieNameStarRedTemplate,null,0),window.location.reload()):alert("Thành viên chưa đăng nhập")},error:function(n){console.log(n)}})}var n=this;$('[data-atc="login"]').each(function(){$(this).on("click",function(t){return(t.preventDefault(),_gl_userId!="")?!1:(n.login(window.location.href),!1)})});$('[data-atc="logout"]').each(function(){$(this).on("click",function(n){return n.preventDefault(),t(),!1})});$('[data-atc="logouttemplatestar"]').each(function(){$(this).on("click",function(n){return n.preventDefault(),setCookie(loginSSO.cookieNameStarRedTemplate,1,2592e3),setCookie("_ck_user",isStarTemplate(isTuoitreSao),2592e3),window.location.reload(),!1})});$("#btnStarTemp,#btnStarTemp1").on("click",function(n){n.preventDefault();setCookie(loginSSO.cookieNameStarRedTemplate,null,0);setCookie("_ck_user",isStarTemplate(isTuoitreSao),2592e3);window.location.reload()})},login:function(n){(typeof n=="undefined"||n=="")&&(n=window.location.origin+window.location.pathname);window.location.href=pageSettings.SSOapiurl+"/api/front/v1/auth/login?redirectUrl="+n},insertUser3rd:function(n){var t=getCookie("_ck_insertuser"),i;if(typeof t!="undefined"&&t!=null&&t!="")return!1;n!=null&&(n.birthTimestamp||(n.birthTimestamp=0),n.email||(n.email=n.phone+"@tuoitre.com.vn"),i={m:"userinsert",username:n.phone?n.phone:n.email,fullName:n.name,avatar:n.avatarPath,email:n.email,phone:n.phone,userid:n.id,sex:n.gender,address:n.address,birthday:new Date(n.birthTimestamp).getFullYear()+"-"+(new Date(n.birthTimestamp).getUTCMonth()+1)+"-"+new Date(n.birthTimestamp).getUTCDate()},$.ajax({url:appSettings.idDomain+"/userprofile.htm",data:i,xhrFields:{withCredentials:!0},type:"GET",contentType:"text/plain",success:function(n){var t=JSON.parse(n);t.code==200&&t.success?setCookie("_ck_insertuser",1,2592e3):t.code==2001&&t.message=="Tài khoản này đã tồn tại."&&setCookie("_ck_insertuser",1,2592e3)}}))}},orderSSOApi={apiGetPack:"https://scontribute.tuoitre.vn/rv/service_pack.json?v="+(new Date).getHours()+(new Date).getDay()+(new Date).getMonth()+(new Date).getFullYear(),pageStarStarPack:function(n,t){var i=this;$.getJSON(i.apiGetPack,function(t){var o="",r,i,u,f,e,s;if(t!=null&&t.length>0){for(r=0;r<t.length;r++)(i=t[r],i.total_money||(i.total_money=0),i.duration||(i.duration=0),n&&i.total_money==0)||(u="",u=i.total_money==0?"Miễn phí":i.total_money.format(0,3,".",",")+"đ",f="",f=i.money==0?"Miễn phí":i.money.format(0,3,".",",")+"đ",e="",e=i.discount?i.discount+"%":"",s=i.name,o+='<li class="pack-selection__item'+(i.code=="TTDB-6M"?" active":"")+'" data-id="'+i.code+'" data-quantity="'+i.duration+'">                                        <span class="isactive"><svg width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.6665 3.9974L4.58317 6.91406L10.4165 1.08073" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><\/svg><\/span>                                         <div class="coll">                                            <div class="info1"><span class="bold">'+s+' <\/span>                                        <span class="bold">'+i.duration+' ngày <\/span><\/div>                                        <span class="price" data-price='+i.total_money+">"+u+'<\/span>                                        <span class="pricebase"><span>'+f+"<\/span>-"+e+"<\/span>                                        <\/div>                                     <\/li>");$("#loadPayPack").html(o);$("#loadPayPack .pack-selection__item").each(function(){var n=$(this);n.on("click",function(){n.hasClass("active")?(n.removeClass("active"),$("#loadPayPack .pack-selection__item").removeClass("active")):($("#loadPayPack .pack-selection__item").removeClass("active"),n.addClass("active"))})})}}).error(function(){console.log("Lỗi load json file:"+i.apiGetPack)});$.getJSON("https://scontribute.tuoitre.vn/rv/service_star.json?v="+(new Date).getHours()+(new Date).getDay()+(new Date).getMonth()+(new Date).getFullYear(),function(i){var h="",c=0,u,r,e,o,s,l,f;if(i!=null&&i.length>0){for(u=0;u<i.length;u++)(r=i[u],r.code!="CUSTOM")&&((r.total_money||(r.total_money=0),r.duration||(r.duration=0),n&&r.total_money==0)||(e="",e=r.total_money==0?"Miễn phí":r.total_money.format(0,3,".",",")+"đ",o="",o=r.money==0?"Miễn phí":r.money.format(0,3,".",",")+"đ",s="",s=r.discount?r.discount+"%":"",l=r.name,h+='<li class="pack-selection__item'+(c==0?" active":"")+'" data-star="'+r.star+'" data-id="'+r.code+'" data-quantity="'+r.duration+'">                                        <span class="isactive"><svg width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.6665 3.9974L4.58317 6.91406L10.4165 1.08073" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><\/svg><\/span>                                         <div class="coll">                                            <div class="info1"><span class="bold">'+l+' <\/span><\/div>                                        <span class="price" data-price='+r.total_money+">"+e+'<\/span>                                        <span class="pricebase"><span>'+o+"<\/span>-"+s+"<\/span>                                        <\/div>                                     <\/li>",c++));$("#loadPayStarPack").html(h);f=$("#loadPayStarPack .pack-selection__item.active").attr("data-star");$(".starwrapperright .txtpaystar").val(parseInt("0"+f).format(0,3,".",","));$(".starwrapperright [data-totalstar]").attr("data-totalstar",f).text(f);$("#loadPayStarPack .pack-selection__item").each(function(){var n=$(this);n.on("click",function(){if(n.hasClass("active"))n.removeClass("active"),$("#loadPayStarPack .pack-selection__item").removeClass("active"),$(".starwrapperright .txtpaystar").val(""),$(".starwrapperright [data-totalstar]").attr("data-totalstar","0").text("0");else{$("#loadPayStarPack .pack-selection__item").removeClass("active");n.addClass("active");var t=parseInt("0"+n.attr("data-star"));$(".starwrapperright .txtpaystar").val(parseInt("0"+t).format(0,3,".",","));$(".starwrapperright [data-totalstar]").attr("data-totalstar",t).text(t)}})});typeof t=="function"&&setTimeout(function(){t()},1500)}}).error(function(){console.log("Lỗi load json file:"+i.apiGetPack)});$(".starwrapperright .txtpaystar").on("keyup",function(){var n=$(this).val()==""?0:$(this).val(),t;n=(n+"").replace(/\./g,"");t=parseFloat(n).format(0,3,".",",");(t==0||isNaN(parseFloat(n))||parseFloat(n)<0)&&(t="");$(this).val(t);$("#loadPayStarPack .pack-selection__item").removeClass("active");n==100?$('#loadPayStarPack .pack-selection__item[data-star="100"]').addClass("active"):n==500?$('#loadPayStarPack .pack-selection__item[data-star="500"]').addClass("active"):n==1e3&&$('#loadPayStarPack .pack-selection__item[data-star="1000"]').addClass("active");$(".starwrapperright [data-totalstar]").attr("data-totalstar",n).text(n)})},getStarPack:function(n,t){var i=this;$.getJSON(i.apiGetPack,function(r){i.buildHtmlStarPack(r,n,t)}).error(function(){console.log("Lỗi load json file:"+i.apiGetPack);i.buildHtmlStarPack(data,n,t)})},buildHtmlStarPack:function(n,t,i){var f="",e=0,u,r,o;if(n!=null&&n.length>0){for(u=0;u<n.length;u++)(r=n[u],r.money||(r.money=0),r.duration||(r.duration=0),t&&r.money==0)||(priceFormat=r.money==0?"Miễn phí":r.total_money.format(0,3,".",",")+"đ",o=r.name,f+='<li class="pack-selection__item'+(e==0?" active":"")+'" data-id="'+r.code+'" data-quantity="'+r.duration+'">                                        <div class="coll">                                            <span class="bold">'+o+' <\/span>                                        <span class="price" data-price='+r.total_money+">"+priceFormat+'<\/span>                                        <\/div>                                               <div class="fromstar">                                            <div class="inputtxt">                                                <input type="text" min="0" data-txtstar="txtpaystar" placeholder="Nhập số sao cần mua" class="txtpaystar" maxlength="5" /><i class="icostar"><\/i>                                            <\/div>                                               <p class="stardes">1 sao = 1000đ. Mua thêm sao để tham gia hoạt động và tương tác trên Tuổi Trẻ như:                                                     <span>Đổi quà lưu niệm <\/span>                                                <span>Tặng sao cho tác giả <\/span>                                                <span>Shopping<\/span>                                            <\/p>                                           <\/div>                                          <\/li>',e++);$("#loadPayPack").html(f);$("#payTotalPrice").attr("data-totalprice",$(".pack-selection__box .pack-selection__item.active").find(".price").attr("data-price"));$("#payTotalPrice").text($(".pack-selection__box .pack-selection__item.active").find(".price").text());$('[data-pack="quantity"]').text($(".pack-selection__box .pack-selection__item.active").attr("data-quantity")+" ngày");$(".pack-selection__box .pack-selection__item").each(function(){var n=$(this);n.on("click",function(){var t,i;$(".pack-selection__box .pack-selection__item").removeClass("active");n.addClass("active");$("#totalStar").attr("data-totalstar",0).text(0);$(".txtpaystar").val("").removeClass("except");t=n.find(".txtpaystar").val()==""?0:n.find(".txtpaystar").val();totalPrice=parseFloat(n.find(".price").attr("data-price"))+parseFloat(t)*1e3;i=totalPrice==0?"Miễn phí":totalPrice.format(0,3,".",",")+"đ";$("#payTotalPrice").text(i).attr("data-totalprice",totalPrice);$('[data-pack="quantity"]').text(n.attr("data-quantity")+" ngày")});n.find(".txtpaystar").on("keyup",function(){var n=$(this).val()==""?0:$(this).val(),t,i,r;n=(n+"").replace(/\./g,"");t=parseFloat(n).format(0,3,".",",");(t==0||isNaN(parseFloat(n))||parseFloat(n)<0)&&(t="");$(this).val(t);totalPrice=parseFloat($(".pack-selection__box .pack-selection__item.active").find(".price").attr("data-price"));$(this).removeClass("except");numStar=parseFloat(n);parseFloat(n)<0&&(numStar=0);$("#totalStar").attr("data-totalstar",numStar).text(numStar);i=parseFloat(totalPrice)+numStar*1e3;r=i==0?"Miễn phí":i.format(0,3,".",",")+"đ";$("#payTotalPrice").text(r).attr("data-totalprice",i)})});typeof i=="function"&&i()}},apiChargePackStar:function(n,t,i,r,u){(typeof t=="undefined"||t=="")&&(t="CUSTOM");var f={starCode:t,subscriptionCode:n,numberOfStars:r,redirectUrl:i};n==""&&(f={starCode:t,numberOfStars:r,redirectUrl:i});r==0&&(f={subscriptionCode:n,redirectUrl:i});$.ajax({url:pageSettings.SSOapiurl+"/api/front/v1/subscriptions-and-stars",headers:{Accept:"application/json"},data:f,method:"POST",type:"POST",xhrFields:{withCredentials:!0},success:function(n){typeof u=="function"&&u(n)},error:function(n){if(typeof u=="function"){var t=n.responseJSON;typeof t=="undefined"&&(t=$.parseJSON(n.responseText));u(t)}}})},apiDonateStar:function(n,t,i){$.ajax({url:pageSettings.SSOapiurl+"/api/front/v1/donations",headers:{Accept:"application/json"},data:{numberOfStars:n,articleLink:t},method:"POST",type:"POST",xhrFields:{withCredentials:!0},success:function(n){typeof i=="function"&&i(n)},error:function(n){if(typeof i=="function"){var t=n.responseJSON;typeof t=="undefined"&&(t=$.parseJSON(n.responseText));i(t)}}})},apiTransferStar:function(n,t,i,r,u,f){if(parseInt("0"+n)>100){var e="?star="+n+"&article_link="+t+"&comment_content=Tặng+sao+cho+thành+viên&name="+r+"&to_member_id="+u+"";window.location.href=pageSettings.SSOapiurl+"/transfer-star"+e}else $.ajax({url:pageSettings.SSOapiurl+"/transfer-star",headers:{Accept:"application/json"},data:{star:n,article_link:t,comment_content:i,name:r,to_member_id:u},method:"GET",type:"GET",xhrFields:{withCredentials:!0},success:function(n){typeof f=="function"&&f(n)},error:function(n){typeof f=="function"&&f(n)}})},clickPopupBuyPack:function(){var n=this;$('[data-atc="showpopupbuypack"]').each(function(){$(this).on("click",function(t){return t.preventDefault(),$("body").addClass("open-modal"),$(".modal__health-advice").hide(),$(".modal__legal-advice").hide(),$("#popupBuyTokenStar").hide(),$("[data-totalstar]").attr("data-totalstar",0).text("0"),$("#loadPayPack").show(),$("#loadPayPack").find("[data-id]").length==0&&n.getStarPack(!0),!1})})},clickPopupBuyStar:function(){var n=this;$('[data-atc="showpopupbuystar"]').each(function(){var n=$(this);n.off("click").on("click",function(n){var t,i,r;n.preventDefault();$("body").addClass("open-modal");$("#popupBuyTokenStar").show();$("#loadPayPack").hide();t=($(".modal__sendreact .fromstar .txtpaystar").val()+"").replace(/\./g,"");t!=""?(i=parseFloat("0"+t)*1e3,r=i==0?"Miễn phí":i.format(0,3,".",",")+"đ",$(".modal__payment .fromstar .txtpaystar").val($(".modal__sendreact .fromstar .txtpaystar").val()),$("[data-totalstar]").attr("data-totalstar",t).text($(".modal__sendreact .fromstar .txtpaystar").val()),$("#payTotalPrice").text(r).attr("data-totalprice",i)):($("[data-totalstar]").attr("data-totalstar",0).text("0"),$("#payTotalPrice").text("0đ").attr("data-totalprice",0));$("#loadPayPack").html("");$("#popupBuyTokenStar").find(".txtpaystar").on("keyup",function(){var n=$(this).val()==""?0:$(this).val(),i,t,r,u;n=(n+"").replace(/\./g,"");i=parseFloat(n).format(0,3,".",",");(i==0||isNaN(parseFloat(n))||parseFloat(n)<0)&&(i="");$(this).val(i);t=parseFloat(n);t<0&&(t=0);$("#totalStar").attr("data-totalstar",t).text(t);r=t*1e3;u=r==0?"Miễn phí":r.format(0,3,".",",")+"đ";$("#payTotalPrice").text(u).attr("data-totalprice",r);$(this).removeClass("except")})})})},initClickChargePackAndStar:function(n,t){var r=this,i=0;$('[data-atc="chargeStar"]').off("click").on("click",function(u){var f,h,c,l;if(u.preventDefault(),f=$(this),!$(this).hasClass("disabled")){if($(this).addClass("disabled"),n==null){if(alert("Bạn chưa đăng nhập, đi tới trang đăng nhập!"),!$(this).hasClass("initedtrigger")&&loginSSO.checkPage=="dang-ky-tuoi-tre-sao"){var e=$("[data-totalstar]").attr("data-totalstar"),o=$("#loadPayPack li.active").attr("data-id"),s=$("#loadPayStarPack li.active").attr("data-id");typeof e=="undefined"&&(e="");typeof o=="undefined"&&(o="");typeof s=="undefined"&&(s="");h={totalstar:e,packcode:o,packstar:s};setCookie(loginSSO.cookieNamePack,JSON.stringify(h),86400)}return loginSSO.login(window.location.href),!1}if(i=parseInt("0"+$("[data-totalstar]").attr("data-totalstar")),i<10&&i>0)return alert("Số sao cần mua tối thiểu là 10!"),$("#popupBuyTokenStar .txtpaystar").addClass("except"),$(this).removeClass("disabled"),!1;if(i>5e3)return alert("Số sao cần mua tối đa là 5.000!"),$("#popupBuyTokenStar .txtpaystar").addClass("except"),$(this).removeClass("disabled"),!1;c=$("#loadPayPack li.active").attr("data-id");l=$("#loadPayStarPack li.active").attr("data-id");r.apiChargePackStar(c,l,t,i,function(n){n.code==200?(f.removeClass("disabled"),loginSSO.checkPage=="detail"&&setCookie("_ckaddstar",$(".modal__sendreact .fromstar .txtpaystar").val(),86400),window.location.href=n.chargeUrl):(n.code==422?n.type==22?alert("Redirect url không được để trống khi cần thực hiện thanh toán."):n.type==3?(alert("Số sao cần mua tối thiểu là 10!"),$(".txtpaystar").addClass("except")):alert(n.error):n.code==401?alert("Bạn chưa đăng nhập! Vui lòng đăng nhập để thực hiện chức năng này!"):alert(n.error),f.removeClass("disabled"))})}})}},pageInit={home:function(n,t,i){console.log("pageInit.home");var r=new Swiper(".home-thamdo-sw",{slidesPerView:"auto",direction:"vertical",mousewheel:{releaseOnEdges:!1},scrollbar:{el:".home-thamdo-sw-scrollbar"}});i&&homeStarTTO_SSOLogin.init(n);t?(homeStarTTO_SSOLogin.getBoxNewsPaper(),$("#tto-start-hcsk").append($(".section__r-suckhoe")),$("#tto-start-tuvan").append($(".section__r-tuvan")),$("#boxTuVanStarTemp").html($("#boxTuVanSubItem")).addClass("box-tuvan-news"),$("#boxTuVanStarTemp").find(".box-category-middle .box-category-item").each(function(){typeof $(this).find("[data-imgstar]").attr("data-imgstar")!="undefined"&&$(this).find("[data-imgstar]").attr("data-imgstar")!=""&&$(this).find("[data-imgstar]").attr("src",$(this).find("[data-imgstar]").attr("data-imgstar"))}),$("#boxTuVanStarTemp").find(".box-category-middle .box-category-item").slice(-2).remove(),$("#boxHomeThamDo").find(".box-qadd").remove(),$("#boxSubTuVan").html($("#boxHomeThamDo")).addClass("home-boxbinhchon"),loadJsAsync("https://js.aiservice.vn/rec/tto_boxforyou.js")):getBoxHome.loadBoxTTOStarRight(t,i);getBoxHome.is_tto_star=i;getBoxHome.init();i?($(""+getBoxHome.wrapper+' *[data-atc="atc-nonstar"]').each(function(){$(this).hide()}),$(""+getBoxHome.wrapper+' *[data-atc="atc-star"]').each(function(){$(this).show()})):($(""+getBoxHome.wrapper+' *[data-atc="atc-nonstar"]').each(function(){$(this).show()}),$(""+getBoxHome.wrapper+' *[data-atc="atc-star"]').each(function(){$(this).hide()}));getBoxHome.getCountCommentVideo();stickyWrapper({elem_sticky:".box-make-sticky",elem_container:".wrapper_right",elem_wrapper:"#stickerhomeright",elem_split:"#sticky_split",elm_width:554})},list:function(n){if(n&&$("#cate_stat_tto_most_views").length>0){var t=7;typeof $("#cate_stat_tto_most_views").attr("data-size")!="undefined"&&(t=$("#cate_stat_tto_most_views").attr("data-size"));let i=0,n=$("#hdZoneId").val(),r=$("#hdZoneUrl").val();typeof n!="undefined"&&n!=""&&(i=n);$.ajax({type:"get",url:"/ajax_timeline_read_most/"+i+"-"+t+".htm",dataType:"html",success:function(n){n!="undefined"&&n!=""&&($("#cate_stat_tto_most_views").html(n),formatTrimLine())},error:function(n){console.log(n)}})}},detail:function(n,t){if(commentv2.init(n),Detail.initPopupObject(),t&&$("#cate_stat_tto_most_views").length>0){let t=0,n=$("#hdZoneId").val();typeof n!="undefined"&&n!=""&&(t=n);$.ajax({type:"get",url:"/ajax_timeline_read_most/"+t+"-7.htm",dataType:"html",success:function(n){n!="undefined"&&n!=""&&($("#cate_stat_tto_most_views").html(n),formatTrimLine())},error:function(n){console.log(n)}})}},detailmagazine:function(n){commentv2.init(n);Detail.initPopupObject()},registerStar:function(n){orderSSOApi.pageStarStarPack(!1,function(){var n=getCookie(loginSSO.cookieNamePack);if(typeof n!="undefined"&&n!=null&&n!=""){var t=$.parseJSON(n),r=t.packcode,i=t.totalstar,u=t.packstar;u==""?$("#loadPayStarPack .pack-selection__item").removeClass("active"):$('#loadPayStarPack .pack-selection__item[data-id="'+u+'"]').trigger("click");r==""?$("#loadPayStarPack .pack-selection__item").removeClass("active"):$('#loadPayPack .pack-selection__item[data-id="'+r+'"]').trigger("click");$('[data-txtstar="txtpaystar"]').val(i);$("[data-totalstar]").attr("data-totalstar",i).text(i);setCookie(loginSSO.cookieNamePack,null,0);setTimeout(function(){$('[data-atc="chargeStar"]').addClass("initedtrigger").trigger("click")},100)}});var t=pageSettings.domain;document.referrer!=""&&document.referrer.startsWith(pageSettings.domain)&&(t=document.referrer);orderSSOApi.initClickChargePackAndStar(n,t)},videoDetail:function(n){mediaPageVideo.DonateStarAuthor(n);mediaPageVideo.ActionNewsFocus(n);commentv2.init(n);DetailVideo.init()},videoDetailStart:function(n,t){mediaPageVideo.DonateStarAuthor(n);mediaPageVideo.ActionNewsFocus(n);commentv2.init(n);DetailVideo.init();t||(alert("Bạn phải là tài khoản Tuổi Trẻ Sao để được xem nội dung này!"),window.location.href="/dang-ky-tuoi-tre-sao.htm")},videoList:function(n){mediaPageVideo.DonateStarAuthor(n);mediaPageVideo.ActionNewsFocus(n);var t="",i="";n!=null&&(t=n.id,i=n.avatarPath);$.cachedScript(appSettings.urlJsId).done(function(){_idSettings.domainId=appSettings.idDomain;initCommentBoxFocus(".media__focus-main .comment-wrapper",$("#hidVideoId").val(),$("#hidVideoZoneId").val(),t,"",i)})},videoListStart:function(n,t){mediaPageVideo.DonateStarAuthor(n);mediaPageVideo.ActionNewsFocus(n);t||(alert("Bạn phải là tài khoản sao để được xem nội dung này!"),window.location.href="/dang-ky-tuoi-tre-sao.htm");loadClickPageVideo();var i="",r="";n!=null&&(i=n.id,r=n.avatarPath);$.cachedScript(appSettings.urlJsId).done(function(){_idSettings.domainId=appSettings.idDomain;initCommentBoxFocus(".media__focus-main .comment-wrapper",$("#hidVideoId").val(),$("#hidVideoZoneId").val(),i,"",r)})},videoHome:function(n){mediaPageVideo.DonateStarAuthor(n);mediaPageVideo.ActionNewsFocus(n);var t="",i="";n!=null&&(t=n.id,i=n.avatarPath);$.cachedScript(appSettings.urlJsId).done(function(){_idSettings.domainId=appSettings.idDomain;initCommentBoxFocus(".media__focus-main .comment-wrapper",$("#hidVideoId").val(),$("#hidVideoZoneId").val(),t,"",i)})},foryou:function(n,t){t?loadJsAsync("https://js.aiservice.vn/rec/tto_indexforyou.js"):(alert("Bạn phải là tài khoản Tuổi Trẻ Sao để được xem nội dung này!"),window.location.href="/dang-ky-tuoi-tre-sao.htm")}};